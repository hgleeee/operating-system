# 프로그램의 구조
## 프로그램의 주소 영역
> 프로그램이 CPU에서 명령을 수행하려면 해당 명령을 담은 프로그램의 주소 영역이 메모리에 올라가 있어야 한다.

### 코드
- 작성한 프로그램 함수들의 코드가 CPU에서 수행할 수 있는 기계어 명령 형태로 변환되어 저장되는 부분

### 데이터
- 전역 변수 등 프로그램이 사용하는 데이터를 저장하는 부분

### 스택
- 함수가 호출될 때 호출된 함수의 수행을 마치고 복귀할 주소 및 데이터를 임시로 저장하는 데에 사용되는 공간
- 함수를 실행하다가 다른 함수를 호출하면 현재 위치를 스택에 저장하고 다른 함수에서 명령을 수행한 뒤 다시 스택에 저장된 주소로 돌아온다.

### 인터럽트
- A라는 프로그램이 CPU를 할당받아 명령을 실행 중 인터럽트가 발생하면 A는 현재 수행중인 명령의 위치를 저장해둔다.
- 이 때 저장하는 위치는 함수 호출과 달리 운영체제가 관리하는 __프로세스 제어블록(PCB)__ 이다.


## 컴퓨터 시스템의 작동 개요
> CPU는 빠른 속도로 처리하는 계산 능력은 갖추고 있지만, 어떤 작업을 수행해야 하는지 스스로 결정하는 능력은 갖추지 못했다.
### 프로그램 카운터 (PC)
> CPU가 수행해야 할 메모리 주소를 담고 있는 레지스터

### 작동
- 모든 컴퓨터 시스템의 동작이 CPU에 의해서만 이루어지지 않는다. 디스크에서 파일을 읽어오기도 하고, 키보드에서 입력을 받기도 한다.
- 이 때, 입출력 장치별로 존재하는 작은 CPU를 __입출력 컨트롤러__ , 메모리를 __로컬버퍼__ 라고 부른다.


### 일반 명령과 특권 명령
#### 일반 명령
- 모든 프로그램이 수행할 수 있는 명령으로 메모리에서 데이터를 읽어와 CPU에서 계산 후 결과를 다시 메모리에 쓰는 일련의 명령
#### 특권 명령
- 보안이 필요한 명령으로 입출력 장치, 타이머 등의 각종 장치에 접근하는 명령
- 운영체제만 수행할 수 있도록 모드비트를 통해 제한한다.

### 시스템 콜
- 사용자 프로그램이 실행되다 보면 일반명령 이외에 특권명령의 수행이 필요할 수 있다.
- 사용자 프로그램은 스스로 특권명령을 수행할 수 없으므로 운영체제에 특권명령의 대행을 요청한다.
- 시스템 콜이 요청되면 커널 영역에 정의된 시스템 콜 처리 코드를 수행한다.
- CPU는 매번 명령을 수행한 후 인터럽트 라인을 체크해 시스템 콜이 들어왔는지 확인하고 주변 장치들은 인터럽트의 종류마다 인터럽트 라인을 다르게 해 구분한다.

#### ex) 디스크에서 자료를 읽어오는 시스템 콜
CPU가 디스크 컨트롤러에게 데이터 읽어오라는 명령을 내리고, 디스크 컨트롤러는 디스크로부터 데이터를 읽어와서 자신의 로컬버퍼에 저장 후 CPU에 인터럽트를 발생시킨다.


